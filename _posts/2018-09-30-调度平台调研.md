---
layout:     post
title:      调度平台
subtitle:   JOB比较
date:       2018-09-30
author:     李俊阳
catalog: true
tags:
    - JOB
    - XXL-JOB
    - Elastic-job-lite
    - Saturn
---
# 调度平台调研

##### 一、需求分析

​	日常开发过程中，我们会有这样的需求，比如，我们需要监控中间件如redis的可用性，这就需要一个定时任务，每分钟1次的频率去ping redis，来探测redis的连通。一般来讲，如果我们的需求是个简单的定时任务，java提供的定时任务，基本能满足我们的需求。当然，现在主流的spring、springboot框架，也都提供了更简单的api来满足我们的需求。比如，springboot，只需要一个@Schedule注解，填入cron表达式，控制我们的任务频率，就可以执行一个定时任务。

​	但是，随着需求的复杂，以及技术架构的演进，单点的定时任务越来越不能满足我们的需求，Quartz框架的出现，为我们提供了更好的任务调度管理，以及多点的可用性，基本能满足我们可用性的要求。如果我们的业务比较简单，没有业务量的要求，在保证可用性的前提下，Quartz框架能很出色的完成我们的需求。

​	随着业务体量的增大，分布式系统的成倍增加。单一的Quartz框架不能够达到量上的处理能力，Quartz集群方式只保证高可用，比如我们上文提到拨测redis可用性的系统，我们称呼为A系统。部署三个节点，假如我们有10W个redis节点需要拨测，Quartz并不能同时让3个节点各自处理大概3W的任务，只是保证节点的可用性，3个节点同时只有1个点去处理任务。这时候，需要进一步地对任务进行分片处理，方便水平扩展增加机器的数量，同时相应地提升系统的批处理能力。目前有很多开源框架都比较轻量级地实现了这一功能，当当网的**elastic-job-lite**,github star比较多的**xxl-job**,以及唯品会的基于当当的elastic-job二次开发的**Saturn**等。

​	这些开源框架，都提供了丰富的功能，以及尽量轻量化的特点，支持分片，也都提供了一套WebUI来管理定时任务，这些WebUI还支持运行一段Java，Python,Shell等脚本。基于以上的一些特点，现在对这些开源框架所提供的功能能来进行研究，方便日后技术选型。

##### 二、特点比较

|            指标            | XXL-JOB | Elastic-job-lite | Saturn |
| :------------------------: | :-----: | :--------------: | :----: |
| 多种作业类型（java/shell） |   是    |        是        |   是   |
|             HA             |   是    |        是        |   是   |
|        弹性动态扩容        |   是    |        是        |   是   |
|            告警            |   是    |        是        |   是   |
|        Job超时处理         |   是    |        是        |   是   |
|          统一配置          |   是    |        是        |   是   |
|            分片            |   是    |        是        |   是   |
|         系统复杂度         |  简单   |      稍简单      |  复杂  |
|         依赖mysql          |   是    |        是        |   是   |
|       依赖zookeeper        |   否    |        是        |   是   |

##### 三、总结

​	开源的分布式调度平台，通过比较，发现基本上差异不大，都能够满足对复杂业务的处理，水平扩展也比较容易。从技术搭建难易角度讲，xxl-job只依赖mysql，最易搭建，Elastic-job-lite和Saturn引入了Zookper来实现节点的发现和任务的抢占，进而控制资源处理，搭建略复杂，相比而言，Saturn的代码实现上要更重量，当然功能也稍显更丰富。
